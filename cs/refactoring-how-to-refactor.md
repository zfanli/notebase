---
type: Refactor
---

# Refactoring: How to Refactor

重构应该用一系列小的变化来完成，每一次变化让现有的代码库有一点改善，同时让程序保存能够完整运行。

## 重构完成的指标

**代码有变干净整洁**

有时会出现重构完代码没有变干净的情况，时间就浪费了。下面这些情况会导致这样的结果：

- 同时重构多个不同的部分，来回切换打断你的思路，尤其是存在时间限制的情况下。
- 代码库本身非常糟糕，你就算做了改善，整个代码库还是一个灾难现场。

第二种情况发生的时候你需要好好考虑是否重写这部分代码比较好。但是最重要的一点，重写之前你需要写测试用例并且留出大块时间。否则你就会遇到改了半天，结果代码还是不干净的状况。

**重构不能和新需求同时进行**

重构和新需求开发不要同时进行，至少不要放在一个提交里面。

**重构后需要通过所有测试用例**

重构后测试用例不通过有 2 种情况：

1. 有 Bug。
2. 测试用例不合适，比如测试私有方法了。

考虑使用 BDD 风格测试用例。
