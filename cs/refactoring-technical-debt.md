---
type: Refactoring
tags: Dev QoK-B
---

# Refactoring: Technical Debt

应该没人会故意乱写代码对项目造成伤害。从零开始编码的时候每个人都会尽力写出优质代码。考虑在什么情况下，开发者会产出“不干净”的代码？

“技术债”这个词，最初由 Wiki 创始人 Ward Cunningham 提出，用来指代“不干净”的代码。

如果你从银行贷款，确实能让你早点买到想要的东西，但是你需要为此付出额外的代价，你需要偿还本金和额外的利息。而且利息会被累计，最终利息都能超过你的总收益，导致债务无法偿还。

“技术债”也是一样的道理，你可以先不写测试用例来赶工期上线新的功能，但这会造成你每天的工作进度逐渐缓慢，最终你意识到你真的要偿还这个技术债，去写测试用例。

下面是几种会产生技术债的场景。

**业务压力**

商业环境有时会强迫你上线未完全完成的功能。这个时候项目代码里面就会出现各种补丁和临时方案。

**未能理解技术债带来的后果**

老板有时可能不理解技术债在不断累积之后会拖累开发的节奏。这会让管理层看不到重构的价值，导致团队很难能投入时间去做重构。

**与组件一致性斗争失败**

当项目是一体化的，没有拆分成多个独立模块时，一个修改可能会造成对其他部分的影响。这样对团队开发非常不友好，这会造成团队每个成员的开发工作不能隔离开。

**缺少测试**

没有及时反馈会滋生快速但是有风险的折中办法或者临时方案。在最坏的情况下，开发完成的功能没有经过任何测试就上线到生产环境。其结果是灾难性的，比如，一个人畜无害的小修改，可能会造成给成百上千的用户发送奇怪的测试邮件，更有甚之，把整个数据库冲掉，或者污染掉。

**缺少文档**

缺少文档会让新人不能快速上手，会让旧人离开之后项目进度停滞不前。

**缺少团队沟通**

如果认知理解不能保证全公司一致，那么就会有人根据过时的理解和信息在工作。这种情况在初级开发者被导师误导后更加严重。

**长期多分支并行开发**

这会造成修改被合并时的技术债的积累。分支隔离的修改越多，技术债越多。

**推迟重构**

项目需求随时变化，某个时间点代码库的一部分代码很明显开始变得过时且冗长，需要考虑重新设计去满足新需求。

另一方面，开发者每天还在基于这些部分产出新的代码。于是重构拖延越久，未来需要返工的代码机会越来越多。

**缺少代码规约检查**

每个人都按照自己觉得合适的方式写代码，没有一个共同的代码规约来约束。

**能力不足**

开发者就是不知道怎么写出像样的代码。
