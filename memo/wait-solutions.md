---
type: Memo
---

# Memo: 等待方案的问题

## 前端架构细节问题

### 后端地址配置获取问题

**背景**

公司研发历史问题，后端从单个服务发展成微服务，后面又合并回单个服务，前端配置随之增加了一堆后端地址的配置，但是前端架构未进行封装，导致对这些配置的引用出现在业务代码各处。

且前端常年处于业务快速迭代，没有足够时间用来对历史代码进行重构，导致后端配置遗留在代码中，但是配置文件中这些配置都指向同一个地址。

现在有一个机会重写前端项目，需要考虑封装后端地址的读取和消费的逻辑。

**需求**

1. 对于构建和发布流程，需要输入一个文件用于替换后端地址
2. 对于开发和测试流程，需要：
   1. 如果能动态生成这个问题，则开发和生产环境保持一致
   2. 如果不能，则开发环境从环境变量中读取，生产从文件读取

目前采用的是生产环境读文件，开发环境读环境变量的方式。想要开发环境和生产环境保持一致，降低开发维护的认知负担，可能需要插件来帮助实现这个处理。在 Vite 下实现一个插件需要从 Rollup 开始了解，需要时间。
